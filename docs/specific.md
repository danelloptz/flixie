# Глоссарий терминов
1. Предложение - фильм или сериал, которые пользователь видит у себя на экране в процессе выбора.
2. Сессия - непосредственно сам процесс выбора фильма/сериала группой лиц.
3. Мэтч - совпадение предложений у всех пользователей.
4. Пользователь – зарегистрированный посетитель сервиса.

# Модели требований
## Предметная область
### Объекты предметной области
1. Пользователь - зарегистрированный посетитель сервиса. 
2. Регистрация и авторизация - процесс идентификации пользователя в системе. 
3. Стартовый экран - главная страница приложения
4. Создание сессии - процесси формирования новой сессии, задание настроек сессии и приглашение друзей в неё. 
5. Сессия выбора - процесс выбора фильма/сериала участниками сессии. 
6. Друзья - страница в приложении, на которой отображаются все пользователи связанные с текущим. 
7. Уведомления - оповещение о новом действии внутри приложения (заявка в друзья, добавление в сессию) либо информационное сообщение. 
8. Настройки - управление личными данными пользователя и параметрами приложения. 
### Связи между объектами
![Схема](pngs/models.png)

## Модели пользователей системы
### Список пользователей
1. Пользователь - зарегистрированный посетитель сервиса. 
2. Гости - посетители сервиса, которые не подтвердили почту. 
### Права пользователей
Пользователь может:
1. **Регистрация и авторизация**
- Зарегистрироваться/авторизоваться с использованием логина и пароля
- Зарегистрироваться/авторизоваться с использованием стороннего сервиса авторизации через OAuth Google
- Подтвердить свою почту, открыв сообщение с подтверждением на своей почте. 
![Регистрация и авторизация](pngs/sequence_auth.png)
2. **Друзья**
- Перейти на страницу друзей. 
- Просматривать уже добавленных друзей
- Добавлять друзей по нику или id
- Приглашать своих друзей присоединиться к сессии
![Друзья](pngs/sequence_friends.png)
3. **Сессии**
- Выбрать доступную сессию и перейти в её интерфейс. 
- Создать новую сессию. 
- Задать имя сессии и период ее жизни
- Управлять параметрами поиска фильма (жанр, возрастные ограничения и т.д.)
- Начать сессию
- Просматривать предложения и их подробную информацию во время сессии. 
- Взаимодействовать с карточкой фильма:        
    * Смахнуть влево -> фильм интересен           
    * Смахнуть вправо -> фильм не интересен            
    * Нажать на карточку фильм / смахнуть вверх -> посмотреть более подробную информацию о фильме         
- Увидеть мэтч. 
![Сессии](pngs/sequence_sessions.png)
4. **Настройки**
- Перейти на страницу с настройками. 
- Изменить личную информацию в настройках. 
![Настройки](pngs/sequence_settings.png)
5. **Уведомления**
- Перейти на страницу уведомлений. 
- Просматривать уведомления о произошедшем за время его отсутствия мэтче
- Нажатие на это уведомление о мэтче демонстрирует информацию о выбранном фильме
- Просматривать уведомления о запросе в друзья
- Нажатием на уведомление о запросе в друзья он может принять или отклонить приглашение
- Просматривать уведомления о присоединении к сессии
- Нажатием на уведомление о присоединении к сессии он может принять или отклонить приглашение
![Уведомления](pngs/sequence_notifications.png)

# Первичный список требований
## Функциональные требования
### 1. Регистрация/авторизация
* 1.1 Пользователь может зарегистрироваться/авторизоваться с использованием логина и пароля
* 1.2 Пользователь может зарегистрироваться/авторизоваться с использованием стороннего сервиса авторизации через OAuth (google, vk)
* 1.3 Пользователь может подтвердить почту в сообщении, которое придет ему на почту
### 2. Главная страница (меню)
* 2.1 Пользователь может выбрать доступную сессию и перейти в [интерфейс сессии](#session-page)
* 2.2 Пользователь может перейти на [страницу настроек](#settings-page)
* 2.3 Пользователь может создать [новую сессию](#create-session-page)
* 2.4 Пользователь может перейти на [страницу друзей](#friends-page)
* 2.5 Пользователь может перейти на [страницу уведомлений](#notification-page)
### 3. Создание сессии <a id="create-session-page"></a>
* 3.1 Пользователь может создать новую сессию
* 3.2 Пользователь может задать имя сессии и период ее жизни
* 3.3 Пользователь может приглашать своих друзей присоединиться к сессии
* 3.4 Пользователь может управлять параметрами поиска фильма (жанр, возрастные ограничения, ...)
* 3.5 Пользователь может закончить настройку сессии с последующим ее началом
### 4. Страница сессии <a id="session-page"></a>
* 4.1 Пользователь видит поверхностную информацию о фильме
* 4.2 Пользователь может cмахнуть карточку фильма влево, если фильм интересен
* 4.3 Пользователь может смахнуть карточку фильма вправо, если фильм не интересен
* 4.4 Пользователь может нажать на карточку фильма или смахнуть вверх, чтобы посмотреть более подробную информацию о фильме
* 4.5 Пользователь может наблюдать событие Match, если получилось определить идеальный фильм
### 5. Страница настроек <a id="settings-page"></a>
* 5.1 Пользователь может изменить (привязать) электронную почту к аккаунту
* 5.2 Пользователь может изменять личную информацию
### 6. Страница друзей <a id="friends-page"></a>
* 6.1 Пользователь может просматривать уже добавленных друзей
* 6.2 Пользователь может добавлять друзей по нику или id
* 6.3 Пользователь может приглашать друзей
### 7. Страница уведомлений <a id="notification-page"></a>
* 7.1 Пользователь может просматривать уведомления о произошедшем за время его отсутствия событии Match
* 7.2 Нажатие на это уведомление демонстрирует информацию о выбранном фильме
* 7.3 Пользователь может просматривать уведомления о запросе в друзья
* 7.4 Нажатием на соответсвующие кнопки он может принять или отклонить приглашение
* 7.5 Пользователь может просматривать уведомления о присоединении к сессии
* 7.6 Нажатием на соответсвующие кнопки он может принять или отклонить приглашение

## Ограничения:
### Средства разработки:

**Backend:**
- Язык программирования: Python.
- Веб-фреймворк: FastAPI.
- ORM: SQLAlchemy.
- Валидация данных: Pydantic.
- База данных: PostgreSQL.
- Аутентификация: JWT + OAuth2 (Google).
- Документация API: автоматически генерируется через Swagger UI / ReDoc.

**Frontend:**
- Фронтенд-фреймворк: Vue.js
- Язык: JavaScript
- Стилизация: CSS
- Роутинг: Vue Router
- Управление состоянием: Vuex
- HTTP-клиент: Axios
- Формат приложения: PWA (Progressive Web App) 

**Инструменты и инфраструктура:**
- Система контроля версий: Git (хостинг: GitHub).
- Контейнеризация: Docker.
- CI/CD: GitHub Actions.
- Тестирование: pytest для backend, jest для frontend

---

### Безопасность и доступ:

- Доступ к функционалу приложения **требует авторизации и подтверждённой электронной почты**.  
  → Гости (пользователи, не подтвердивший email) имеют доступ **только к профилю и настройкам** — с возможностью отправки письма подтверждения.  
  → Все остальные функции (создание/участие в сессиях, добавление друзей, просмотр фильмов) **заблокированы** до подтверждения почты.

- Используется схема аутентификации на основе **JWT с access и refresh токенами**:
  - **Access-токен** — срок жизни **15 минут**, используется для авторизованных запросов к API.
  - **Refresh-токен** — срок жизни **7 дней**, используется для получения новой пары токенов без повторного ввода логина/пароля.
  - Оба токена **деактивируются** при:
    - Явном выходе из аккаунта (logout).
    - Смене пароля.

- Пароли хранятся в базе данных в **хешированном виде с использованием bcrypt**.

- OAuth-авторизация поддерживается **только через Google**.  

- Роли пользователей:

  - **Неавторизованный пользователь**  
    1. **Доступ запрещён полностью.**  
    2. Любая попытка открыть приложение перенаправляет на страницу входа/регистрации.  
    3. Главная страница недоступна без авторизации.

  - **Гость (email не подтверждён)**  
    1. Пользователь прошёл регистрацию, но **ещё не подтвердил email**.  
    2. Получает **ограниченный доступ только к разделу «Настройки профиля»** с возможностью:  
      ✓ Просматривать и редактировать свой email.  
      ✓ Запрашивать повторную отправку письма подтверждения.  
      ✓ Выходить из аккаунта.  
    3. **Все остальные разделы (сессии, друзья, фильмы, уведомления) — заблокированы.**  
    4. В интерфейсе отображается баннер с напоминанием подтвердить почту.

  - **Пользователь (email подтверждён — базовая роль)**  
    1. После подтверждения email — автоматически получает **полный доступ ко всем функциям**:  
      ✓ Создание и управление сессиями.  
      ✓ Участие в выборе фильмов (свайпы, мэтчи).  
      ✓ Добавление, просмотр и управление друзьями.  
      ✓ Настройки профиля, уведомлений, безопасности.  
      ✓ Просмотр уведомлений.  
    2. Это основная рабочая роль для всех активных пользователей.

---

### Требования к системе (интерфейсу):

1.  Пользовательский интерфейс доступен **только на русском языке**.
2.  Приложение реализовано как **PWA** — должно корректно работать на мобильных устройствах (iOS/Android) и поддерживать установку на домашний экран.
3. Поддерживаемые браузеры (последние версии на момент релиза):
  - Google Chrome
  - Yandex Browser
  - Safari (iOS)
  - Microsoft Edge
  - Firefox (опционально)

4. Архитектура frontend — компонентная (Vue 3), backend — REST API с четким разделением слоёв.
5. При регистрации:
  - Логин: от 3 до 30 символов.
  - Пароль: от 8 до 64 символов.
6. Пользователь может создать **не более 5 активных сессий одновременно**.
7. В одной сессии может участвовать **не более 10 пользователей**.
8. Пользователь может иметь **не более 200 друзей**.
10. Поиск фильмов фильтруется по жанрам, рейтингу, году выпуска.
11. Интерфейс карточки фильма поддерживает свайпы (влево — «интересно», вправо — «не интересно», вверх — детали).
12. Push-уведомления о событиях Match, приглашениях в друзья и сессии.

---

## Дополнительные технические требования:
- Backend должен быть stateless — вся сессионная логика хранится в БД.
- Все изображения и тяжелые ресурсы должны лениво подгружаться (lazy load).
- Приложение должно быть отзывчивым (responsive) — корректно отображаться на экранах от 320px по ширине.